{% load static %}

{% block title %}
<title>ScoopJoy üç¶ - Login</title>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/login.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/login.js' %}" defer></script>
{% endblock %}

{% block content %}
<div class="modal">
    <span class="close-btn" onclick="window.location.href='/'">√ó</span>
    <h2 id="login-heading">Login to ScoopJoy üç¶</h2>

    {% if messages %}
        <div class="form-error">
            {% for message in messages %}
                <p class="error">{{ message }}</p>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Login Form -->
    <form id="login-form" method="POST" action="{% url 'scoopjoy:login' %}">
        {% csrf_token %}
        <p>
            <label for="id_username">Username or Email</label>
            <input type="text" id="id_username" name="username" required>
        </p>
        <p class="password-field">
            <label for="id_password">Password</label>
            <input type="password" id="id_password" name="password" required>
            <i class="fas fa-eye toggle-password" onclick="togglePassword()"></i>
        </p>
        <button type="submit" class="login-btn">Login</button>
    </form>

    <!-- Links Section -->
    <div id="login-links">
        <p><a href="#" id="forgot-password-link">Forgot Password?</a></p>
        <p><a href="#" id="login-with-otp-link">Login with OTP</a></p>
        <p>Don't have an account? <a href="{% url 'scoopjoy:signup' %}">Signup here</a></p>
    </div>

    <!-- Forgot Password Form -->
    <form id="forgot-password-form" style="display: none;">
        {% csrf_token %}
        <p><input type="email" id="forgot-email" name="email" placeholder="Enter your email" required></p>
        <button type="submit" class="login-btn">Send Reset Link</button>
        <p id="forgot-password-message" class="form-message"></p>
        <p><a href="#" id="back-to-login-from-forgot">‚Üê Back</a></p>
    </form>

    <!-- OTP Request Form -->
    <form id="otp-request-form" style="display: none;">
        {% csrf_token %}
        <p><input type="email" id="otp-email" name="email" placeholder="Enter your email" required></p>
        <button type="submit" class="login-btn">Send OTP</button>
        <p id="otp-request-message" class="form-message"></p>
        <p><a href="#" id="back-to-login-from-otp">‚Üê Back</a></p>
    </form>

    <!-- OTP Verify Form -->
    <form id="otp-verify-form" style="display: none;">
        {% csrf_token %}
        <p><input type="text" id="otp-code" name="otp" placeholder="Enter OTP" required></p>
        <button type="submit" class="login-btn">Verify OTP</button>
        <p id="otp-verify-message" class="form-message"></p>
    </form>
</div>
{% endblock %}
